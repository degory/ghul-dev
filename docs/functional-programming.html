<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>functional programming | ghūl programming language</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="stylesheet" href="/prism-vsc-dark-plus.css">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="ghūl programming language">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="keywords" content="ghul, ghul programming language, ghoul, ghoul programming language, ghūl, ghūl programming language">
    
    <link rel="preload" href="/assets/css/0.styles.b0bd399e.css" as="style"><link rel="preload" href="/assets/js/app.471c6157.js" as="script"><link rel="preload" href="/assets/js/2.d0d5977e.js" as="script"><link rel="preload" href="/assets/js/1.a053b9db.js" as="script"><link rel="preload" href="/assets/js/32.95725b61.js" as="script"><link rel="prefetch" href="/assets/js/10.7cbc8b3d.js"><link rel="prefetch" href="/assets/js/11.f206c2fa.js"><link rel="prefetch" href="/assets/js/12.8e113096.js"><link rel="prefetch" href="/assets/js/13.4fc459fc.js"><link rel="prefetch" href="/assets/js/14.79be315a.js"><link rel="prefetch" href="/assets/js/15.75678467.js"><link rel="prefetch" href="/assets/js/16.8c2a8dca.js"><link rel="prefetch" href="/assets/js/17.4659f144.js"><link rel="prefetch" href="/assets/js/18.78f87d15.js"><link rel="prefetch" href="/assets/js/19.687fa966.js"><link rel="prefetch" href="/assets/js/20.f8afd611.js"><link rel="prefetch" href="/assets/js/21.359314cd.js"><link rel="prefetch" href="/assets/js/22.1f905eaa.js"><link rel="prefetch" href="/assets/js/23.8b8f7a47.js"><link rel="prefetch" href="/assets/js/24.73c8580c.js"><link rel="prefetch" href="/assets/js/25.f278fd52.js"><link rel="prefetch" href="/assets/js/26.f70ac138.js"><link rel="prefetch" href="/assets/js/27.563daeae.js"><link rel="prefetch" href="/assets/js/28.df8d055b.js"><link rel="prefetch" href="/assets/js/29.e452be63.js"><link rel="prefetch" href="/assets/js/3.789d2799.js"><link rel="prefetch" href="/assets/js/30.23f54651.js"><link rel="prefetch" href="/assets/js/31.1b032d5b.js"><link rel="prefetch" href="/assets/js/33.03d79032.js"><link rel="prefetch" href="/assets/js/34.94eac50d.js"><link rel="prefetch" href="/assets/js/35.52819f56.js"><link rel="prefetch" href="/assets/js/36.df3e3fd3.js"><link rel="prefetch" href="/assets/js/37.b8bf6ac3.js"><link rel="prefetch" href="/assets/js/38.25acf731.js"><link rel="prefetch" href="/assets/js/39.ed6a0739.js"><link rel="prefetch" href="/assets/js/4.2750cc6e.js"><link rel="prefetch" href="/assets/js/40.baae781f.js"><link rel="prefetch" href="/assets/js/41.ddfc6077.js"><link rel="prefetch" href="/assets/js/42.6f24495c.js"><link rel="prefetch" href="/assets/js/43.a13f7e0a.js"><link rel="prefetch" href="/assets/js/44.3fb97272.js"><link rel="prefetch" href="/assets/js/45.42d3fc69.js"><link rel="prefetch" href="/assets/js/5.a0237d0a.js"><link rel="prefetch" href="/assets/js/6.b7ad37cd.js"><link rel="prefetch" href="/assets/js/7.a507e3fa.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.271bc088.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b0bd399e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">ghūl programming language</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/" aria-current="page" class="sidebar-link">overview</a></li><li><a href="/getting-started.html" class="sidebar-link">getting started</a></li><li><a href="/language-basics.html" class="sidebar-link">language basics</a></li><li><a href="/definitions.html" class="sidebar-link">definitions</a></li><li><a href="/expressions.html" class="sidebar-link">expressions</a></li><li><a href="/control-flow.html" class="sidebar-link">control flow</a></li><li><a href="/functional-programming.html" aria-current="page" class="active sidebar-link">functional programming</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/functional-programming.html#first-class-functions" class="sidebar-link">first class functions</a></li><li class="sidebar-sub-header"><a href="/functional-programming.html#filter-map-reduce" class="sidebar-link">filter, map, reduce</a></li><li class="sidebar-sub-header"><a href="/functional-programming.html#recursion" class="sidebar-link">recursion</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/functional-programming.html#self-recursion-in-anonymous-functions" class="sidebar-link">self recursion in anonymous functions</a></li><li class="sidebar-sub-header"><a href="/functional-programming.html#mutual-recursion-in-anonymous-functions" class="sidebar-link">mutual recursion in anonymous functions</a></li><li class="sidebar-sub-header"><a href="/functional-programming.html#mutual-recursion-in-named-functions" class="sidebar-link">mutual recursion in named functions</a></li></ul></li><li class="sidebar-sub-header"><a href="/functional-programming.html#immutable-data-structures-and-pure-functions" class="sidebar-link">immutable data structures and pure functions</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/functional-programming.html#lists-are-immutable-by-default" class="sidebar-link">lists are immutable by default</a></li><li class="sidebar-sub-header"><a href="/functional-programming.html#maps-are-immutable-by-default" class="sidebar-link">maps are immutable by default</a></li><li class="sidebar-sub-header"><a href="/functional-programming.html#arrays-are-immutable" class="sidebar-link">arrays are immutable</a></li><li class="sidebar-sub-header"><a href="/functional-programming.html#array-literals-are-immutable" class="sidebar-link">array literals are immutable</a></li><li class="sidebar-sub-header"><a href="/functional-programming.html#tuples-are-immutable" class="sidebar-link">tuples are immutable</a></li><li class="sidebar-sub-header"><a href="/functional-programming.html#tuple-literals-are-immutable" class="sidebar-link">tuple literals are immutable</a></li><li class="sidebar-sub-header"><a href="/functional-programming.html#properties-are-not-publicly-assignable-by-default" class="sidebar-link">properties are not publicly assignable by default</a></li><li class="sidebar-sub-header"><a href="/functional-programming.html#pipes-support-non-mutating-operations-over-lists" class="sidebar-link">pipes support non mutating operations over lists</a></li><li class="sidebar-sub-header"><a href="/functional-programming.html#expression-oriented-programming" class="sidebar-link">expression oriented programming</a></li></ul></li><li class="sidebar-sub-header"><a href="/functional-programming.html#higher-order-functions" class="sidebar-link">higher order functions</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/functional-programming.html#higher-order-generically-typed-global-functions" class="sidebar-link">higher order generically typed global functions</a></li><li class="sidebar-sub-header"><a href="/functional-programming.html#higher-order-generically-typed-methods" class="sidebar-link">higher order generically typed methods:</a></li><li class="sidebar-sub-header"><a href="/functional-programming.html#higher-order-anonymous-functions" class="sidebar-link">higher order anonymous functions:</a></li></ul></li><li class="sidebar-sub-header"><a href="/functional-programming.html#union-types" class="sidebar-link">union types</a></li><li class="sidebar-sub-header"><a href="/functional-programming.html#pattern-matching-todo" class="sidebar-link">pattern matching (TODO)</a></li><li class="sidebar-sub-header"><a href="/functional-programming.html#currying" class="sidebar-link">currying</a></li><li class="sidebar-sub-header"><a href="/functional-programming.html#partial-application" class="sidebar-link">partial application</a></li><li class="sidebar-sub-header"><a href="/functional-programming.html#lazy-evaluation-todo" class="sidebar-link">lazy evaluation (TODO)</a></li></ul></li><li><a href="/object-oriented-programming.html" class="sidebar-link">object oriented programming</a></li><li><a href="/generics.html" class="sidebar-link">generics</a></li><li><a href="/type-inference.html" class="sidebar-link">type inference</a></li><li><a href="/dotnet-integration.html" class="sidebar-link">.NET integration</a></li><li><a href="/grammar.html" class="sidebar-link">grammar</a></li><li><a href="/known-issues.html" class="sidebar-link">known issues</a></li><li><a href="/resources.html" class="sidebar-link">resources</a></li><li><a href="/history.html" class="sidebar-link">history</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="functional-programming"><a href="#functional-programming" class="header-anchor">#</a> functional programming</h1> <p>ghūl has some support for basic functional programming</p> <h2 id="first-class-functions"><a href="#first-class-functions" class="header-anchor">#</a> first class functions</h2> <p>ghūl has first class functions. There is a function literal syntax that
constructs functions, which can then be called, but also assigned to
variables, passed to other functions, stored in data structures, or
pretty much anything else you can do with any other ghūl value</p> <div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul"><span class="token keyword">let</span> <span class="token variable">f</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">i</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token variable">i</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token variable">g</span> <span class="token operator">=</span> <span class="token variable">f</span><span class="token punctuation">;</span>
<span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> <span class="token function">ff</span><span class="token punctuation">(</span><span class="token variable">f</span>: <span class="token class-name">int</span> <span class="token operator">-&gt;</span> <span class="token class-name">int</span><span class="token punctuation">,</span> <span class="token variable">i</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token variable">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="filter-map-reduce"><a href="#filter-map-reduce" class="header-anchor">#</a> filter, map, reduce</h2> <p>ghūl pipes provide filter, map and reduce as well as other ways to
work with sequences of values</p> <div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul"><span class="token comment">// map</span>
<span class="token keyword">let</span> <span class="token variable">doubled</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token operator">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token variable">x</span> <span class="token operator">=&gt;</span> <span class="token variable">x</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;doubled: <span class="token interpolation"><span class="token interpolation-punctuation punctuation">{</span><span class="token variable">doubled</span><span class="token interpolation-punctuation punctuation">}</span></span>&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// filter</span>
<span class="token keyword">let</span> <span class="token variable">evens</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token operator">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">x</span> <span class="token operator">=&gt;</span> <span class="token variable">x</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;evens: <span class="token interpolation"><span class="token interpolation-punctuation punctuation">{</span><span class="token variable">evens</span><span class="token interpolation-punctuation punctuation">}</span></span>&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// reduce</span>
<span class="token keyword">let</span> <span class="token variable">sum</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token operator">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token variable">acc</span><span class="token punctuation">,</span> <span class="token variable">x</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token variable">acc</span> <span class="token operator">+</span> <span class="token variable">x</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;sum: <span class="token interpolation"><span class="token interpolation-punctuation punctuation">{</span><span class="token variable">sum</span><span class="token interpolation-punctuation punctuation">}</span></span>&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="recursion"><a href="#recursion" class="header-anchor">#</a> recursion</h2> <p>ghūl methods, global functions and anonymous functions
can all call themselves or each other recursively</p> <h3 id="self-recursion-in-anonymous-functions"><a href="#self-recursion-in-anonymous-functions" class="header-anchor">#</a> self recursion in anonymous functions</h3> <div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul"><span class="token comment">// factorial</span>
<span class="token keyword">let</span> <span class="token variable">factorial</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">n</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token keyword">rec</span> <span class="token operator">=&gt;</span> <span class="token control">if</span> <span class="token variable">n</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token control">then</span> <span class="token number">1</span> <span class="token control">else</span> <span class="token variable">n</span> <span class="token operator">*</span> <span class="token keyword">rec</span><span class="token punctuation">(</span><span class="token variable">n</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token control">fi</span><span class="token punctuation">;</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;factorial(5): <span class="token interpolation"><span class="token interpolation-punctuation punctuation">{</span><span class="token function">factorial</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span>&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// fibonacci</span>
<span class="token keyword">let</span> <span class="token variable">fibonacci</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">n</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token keyword">rec</span> <span class="token operator">=&gt;</span> <span class="token control">if</span> <span class="token variable">n</span> <span class="token operator">&lt;=</span> <span class="token number">1</span> <span class="token control">then</span> <span class="token variable">n</span> <span class="token control">else</span> <span class="token keyword">rec</span><span class="token punctuation">(</span><span class="token variable">n</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token keyword">rec</span><span class="token punctuation">(</span><span class="token variable">n</span> <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token control">fi</span><span class="token punctuation">;</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;fibonacci(10): <span class="token interpolation"><span class="token interpolation-punctuation punctuation">{</span><span class="token function">fibonacci</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span>&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="mutual-recursion-in-anonymous-functions"><a href="#mutual-recursion-in-anonymous-functions" class="header-anchor">#</a> mutual recursion in anonymous functions</h3> <p>Mutual recursion for anonymous functions is slightly awkward, but possible
by passing one function into the other as an argument:</p> <div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul">
<span class="token keyword">let</span> <span class="token variable">is_even</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">n</span>: <span class="token class-name">int</span><span class="token punctuation">,</span> <span class="token variable">is_odd</span>: <span class="token class-name">int</span> <span class="token operator">-&gt;</span> <span class="token class-name">bool</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token control">if</span> <span class="token variable">n</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token control">then</span> <span class="token boolean">true</span> <span class="token control">else</span> <span class="token function">is_odd</span><span class="token punctuation">(</span><span class="token variable">n</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token control">fi</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token variable">is_odd</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">n</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token keyword">rec</span> <span class="token operator">=&gt;</span> <span class="token control">if</span> <span class="token variable">n</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token control">then</span> <span class="token boolean">false</span> <span class="token control">else</span> <span class="token function">is_even</span><span class="token punctuation">(</span><span class="token variable">n</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">rec</span><span class="token punctuation">)</span> <span class="token control">fi</span><span class="token punctuation">;</span>

<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;even(10): <span class="token interpolation"><span class="token interpolation-punctuation punctuation">{</span><span class="token function">is_even</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token variable">is_odd</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span>&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;odd(10): <span class="token interpolation"><span class="token interpolation-punctuation punctuation">{</span><span class="token function">is_odd</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span>&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="mutual-recursion-in-named-functions"><a href="#mutual-recursion-in-named-functions" class="header-anchor">#</a> mutual recursion in named functions</h3> <p>Mututal recursion with named functions, doesn't require any workarounds</p> <div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul"><span class="token function">is_even</span><span class="token punctuation">(</span><span class="token variable">n</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">bool</span> <span class="token keyword">is</span>
    <span class="token control">if</span> <span class="token variable">n</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token control">then</span> <span class="token boolean">true</span> <span class="token control">else</span> <span class="token function">is_odd</span><span class="token punctuation">(</span><span class="token variable">n</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token control">fi</span><span class="token punctuation">;</span>
<span class="token keyword">si</span>

<span class="token function">is_odd</span><span class="token punctuation">(</span><span class="token variable">n</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">bool</span> <span class="token keyword">is</span>
    <span class="token control">if</span> <span class="token variable">n</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token control">then</span> <span class="token boolean">false</span> <span class="token control">else</span> <span class="token function">is_even</span><span class="token punctuation">(</span><span class="token variable">n</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token control">fi</span><span class="token punctuation">;</span>
<span class="token keyword">si</span>
</code></pre></div><h2 id="immutable-data-structures-and-pure-functions"><a href="#immutable-data-structures-and-pure-functions" class="header-anchor">#</a> immutable data structures and pure functions</h2> <p>While ghūl supports imperitive code it also aims to support
writing pure functions with appropriate constructs and defaults</p> <h3 id="lists-are-immutable-by-default"><a href="#lists-are-immutable-by-default" class="header-anchor">#</a> lists are immutable by default</h3> <p>The standard trait for lists <code>Collections.List[T]</code> is immutable (it maps to .NET's <code>System.Collections.Generic.IReadOnlyList`1[T]</code>)</p> <h3 id="maps-are-immutable-by-default"><a href="#maps-are-immutable-by-default" class="header-anchor">#</a> maps are immutable by default</h3> <p>The standard trait for maps <code>Collections.Map[T]</code> is immutable (it maps to .NET's <code>System.Collections.Generic.IReadOnlyDictionary`2[K,V]</code>)</p> <h3 id="arrays-are-immutable"><a href="#arrays-are-immutable" class="header-anchor">#</a> arrays are immutable</h3> <p>The ghūl array type <code>T[]</code> does not expose an assign indexer</p> <h3 id="array-literals-are-immutable"><a href="#array-literals-are-immutable" class="header-anchor">#</a> array literals are immutable</h3> <p>The values constructed by array literals are immutable</p> <div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul"><span class="token keyword">let</span> <span class="token variable">list</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> <span class="token variable">element</span> <span class="token operator">=</span> <span class="token variable">list</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// elements can be read</span>

<span class="token comment">// the list is an instance of an immutable type:</span>
<span class="token control">assert</span> <span class="token variable">list</span><span class="token operator">.</span><span class="token function">get_type</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">typeof</span> <span class="token class-name">Collections</span><span class="token operator">.</span><span class="token class-name">List</span><span class="token punctuation">[</span><span class="token class-name">int</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token variable">element</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span> <span class="token comment">// elements cannot be assigned to - compile time error</span>
</code></pre></div><h3 id="tuples-are-immutable"><a href="#tuples-are-immutable" class="header-anchor">#</a> tuples are immutable</h3> <p>Values of ghūl tuple types <code>(T1, T2, T3, ...)</code> are immutable (the elements <code>`0</code>, <code>`1</code>, <code>`2</code>, ... do not have assign accessors)</p> <h3 id="tuple-literals-are-immutable"><a href="#tuple-literals-are-immutable" class="header-anchor">#</a> tuple literals are immutable</h3> <p>The values constructed by tuple literals are immutable</p> <div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul"><span class="token keyword">let</span> <span class="token variable">tuple</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> <span class="token variable">element</span> <span class="token operator">=</span> <span class="token variable">tuple</span><span class="token operator">.</span>`<span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">// elements can be read</span>

<span class="token comment">// the tuple is an instance of an immutable type:</span>
<span class="token control">assert</span> <span class="token variable">tuple</span><span class="token operator">.</span><span class="token variable">get_type</span> <span class="token operator">==</span> <span class="token keyword">typeof</span> <span class="token punctuation">(</span><span class="token class-name">int</span><span class="token punctuation">,</span> <span class="token class-name">int</span><span class="token punctuation">,</span> <span class="token class-name">int</span><span class="token punctuation">,</span> <span class="token class-name">int</span><span class="token punctuation">,</span> <span class="token class-name">int</span><span class="token punctuation">)</span>

<span class="token variable">tuple</span><span class="token operator">.</span>`<span class="token number">3</span> <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span> <span class="token comment">// elements cannot be assigned to - compile time error</span>
</code></pre></div><h3 id="properties-are-not-publicly-assignable-by-default"><a href="#properties-are-not-publicly-assignable-by-default" class="header-anchor">#</a> properties are not publicly assignable by default</h3> <p>When defining properties in classes and structs, they are not
publicly assignable by default</p> <div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul"><span class="token keyword">struct</span> <span class="token class-name">THING</span> <span class="token keyword">is</span>
    <span class="token variable">name</span>: <span class="token class-name">string</span><span class="token punctuation">;</span>

    <span class="token function">init</span><span class="token punctuation">(</span><span class="token variable">name</span>: <span class="token class-name">string</span><span class="token punctuation">)</span> <span class="token keyword">is</span>
        <span class="token variable">self</span><span class="token operator">.</span><span class="token variable">name</span> <span class="token operator">=</span> <span class="token variable">name</span><span class="token punctuation">;</span>
    <span class="token keyword">si</span>
<span class="token keyword">si</span>

<span class="token keyword">let</span> <span class="token variable">thing</span> <span class="token operator">=</span> <span class="token class-name">THING</span><span class="token punctuation">(</span><span class="token string">&quot;a thing&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">thing</span><span class="token operator">.</span><span class="token variable">name</span> <span class="token operator">=</span> <span class="token string">&quot;change it&quot;</span><span class="token punctuation">;</span> <span class="token comment">// compile time error</span>
</code></pre></div><h3 id="pipes-support-non-mutating-operations-over-lists"><a href="#pipes-support-non-mutating-operations-over-lists" class="header-anchor">#</a> pipes support non mutating operations over lists</h3> <p>pipes make it easy to iterate over lists and generators producing
transformed output without mutating the source data</p> <div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul"><span class="token keyword">let</span> <span class="token variable">list</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> <span class="token variable">doubled</span> <span class="token operator">=</span> <span class="token variable">list</span> <span class="token operator">|</span> <span class="token operator">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token variable">x</span> <span class="token operator">=&gt;</span> <span class="token variable">x</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// original list is still the same:</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;list: <span class="token interpolation"><span class="token interpolation-punctuation punctuation">{</span><span class="token variable">list</span><span class="token operator">|</span> <span class="token interpolation-punctuation punctuation">}</span></span>&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="expression-oriented-programming"><a href="#expression-oriented-programming" class="header-anchor">#</a> expression oriented programming</h3> <p>Expression bodied functions and some support for
expression oriented programming help in writing
pure functions</p> <div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul"><span class="token keyword">let</span> <span class="token variable">add</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">x</span>: <span class="token class-name">int</span><span class="token punctuation">,</span> <span class="token variable">y</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token variable">x</span> <span class="token operator">+</span> <span class="token variable">y</span><span class="token punctuation">;</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;add(5, 3): <span class="token interpolation"><span class="token interpolation-punctuation punctuation">{</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span>&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> <span class="token variable">classify</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">n</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    <span class="token control">if</span> <span class="token variable">n</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token control">then</span>
        <span class="token string">&quot;Zero&quot;</span>
    <span class="token control">elif</span> <span class="token variable">n</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">/\</span> <span class="token variable">n</span> <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token control">then</span>
        <span class="token control">if</span> <span class="token variable">n</span> <span class="token operator">%</span> <span class="token number">5</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token control">then</span> <span class="token string">&quot;Negative even and multiple of 5&quot;</span> <span class="token control">else</span> <span class="token string">&quot;Negative even&quot;</span> <span class="token control">fi</span>
    <span class="token control">elif</span> <span class="token variable">n</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">/\</span> <span class="token variable">n</span> <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token control">then</span>
        <span class="token control">if</span> <span class="token variable">n</span> <span class="token operator">%</span> <span class="token number">5</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token control">then</span> <span class="token string">&quot;Negative odd and multiple of 5&quot;</span> <span class="token control">else</span> <span class="token string">&quot;Negative odd&quot;</span> <span class="token control">fi</span>
    <span class="token control">elif</span> <span class="token variable">n</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token control">then</span>
        <span class="token control">if</span> <span class="token variable">n</span> <span class="token operator">%</span> <span class="token number">5</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token control">then</span> <span class="token string">&quot;Positive even and multiple of 5&quot;</span> <span class="token control">else</span> <span class="token string">&quot;Positive even&quot;</span> <span class="token control">fi</span>
    <span class="token control">else</span>
        <span class="token control">if</span> <span class="token variable">n</span> <span class="token operator">%</span> <span class="token number">5</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token control">then</span> <span class="token string">&quot;Positive odd and multiple of 5&quot;</span> <span class="token control">else</span> <span class="token string">&quot;Positive odd&quot;</span> <span class="token control">fi</span>
    <span class="token control">fi</span><span class="token punctuation">;</span>

<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;classifyNumber(-10): <span class="token interpolation"><span class="token interpolation-punctuation punctuation">{</span><span class="token function">classify</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span>&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;classifyNumber(-3): <span class="token interpolation"><span class="token interpolation-punctuation punctuation">{</span><span class="token function">classify</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span>&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;classifyNumber(0): <span class="token interpolation"><span class="token interpolation-punctuation punctuation">{</span><span class="token function">classify</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span>&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;classifyNumber(4): <span class="token interpolation"><span class="token interpolation-punctuation punctuation">{</span><span class="token function">classify</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span>&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;classifyNumber(25): <span class="token interpolation"><span class="token interpolation-punctuation punctuation">{</span><span class="token function">classify</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span>&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        

</code></pre></div><h2 id="higher-order-functions"><a href="#higher-order-functions" class="header-anchor">#</a> higher order functions</h2> <h3 id="higher-order-generically-typed-global-functions"><a href="#higher-order-generically-typed-global-functions" class="header-anchor">#</a> higher order generically typed global functions</h3> <div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul"><span class="token variable">apply</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token variable">f</span>: <span class="token class-name">T</span> <span class="token operator">-&gt;</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token variable">x</span>: <span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">T</span> <span class="token operator">=&gt;</span>
    <span class="token function">f</span><span class="token punctuation">(</span><span class="token variable">x</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">apply_if</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token variable">f</span>: <span class="token class-name">T</span> <span class="token operator">-&gt;</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token variable">x</span>: <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token variable">predicate</span>: <span class="token class-name">T</span> <span class="token operator">-&gt;</span> <span class="token class-name">bool</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">T</span> <span class="token operator">=&gt;</span>
    <span class="token control">if</span> <span class="token function">predicate</span><span class="token punctuation">(</span><span class="token variable">x</span><span class="token punctuation">)</span> <span class="token control">then</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token variable">x</span><span class="token punctuation">)</span> <span class="token control">else</span> <span class="token variable">x</span> <span class="token control">fi</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="higher-order-generically-typed-methods"><a href="#higher-order-generically-typed-methods" class="header-anchor">#</a> higher order generically typed methods:</h3> <div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul"><span class="token keyword">class</span> <span class="token class-name">HIGHER_ORDER_FUNCTIONS</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">]</span> <span class="token keyword">is</span>
    <span class="token function">apply</span><span class="token punctuation">(</span><span class="token variable">f</span>: <span class="token class-name">T</span> <span class="token operator">-&gt;</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token variable">x</span>: <span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">T</span> <span class="token keyword">static</span> <span class="token operator">=&gt;</span>
        <span class="token function">f</span><span class="token punctuation">(</span><span class="token variable">x</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">apply_if</span><span class="token punctuation">(</span><span class="token variable">f</span>: <span class="token class-name">T</span> <span class="token operator">-&gt;</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token variable">x</span>: <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token variable">predicate</span>: <span class="token class-name">T</span> <span class="token operator">-&gt;</span> <span class="token class-name">bool</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">T</span> <span class="token keyword">static</span> <span class="token operator">=&gt;</span>
        <span class="token control">if</span> <span class="token function">predicate</span><span class="token punctuation">(</span><span class="token variable">x</span><span class="token punctuation">)</span> <span class="token control">then</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token variable">x</span><span class="token punctuation">)</span> <span class="token control">else</span> <span class="token variable">x</span> <span class="token control">fi</span><span class="token punctuation">;</span>
<span class="token keyword">si</span>
</code></pre></div><h3 id="higher-order-anonymous-functions"><a href="#higher-order-anonymous-functions" class="header-anchor">#</a> higher order anonymous functions:</h3> <div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul"><span class="token keyword">let</span> <span class="token variable">times_2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">x</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token variable">x</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;apply(times_2, 5): <span class="token interpolation"><span class="token interpolation-punctuation punctuation">{</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token variable">times_2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span>&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> <span class="token variable">square</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">x</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token variable">x</span> <span class="token operator">*</span> <span class="token variable">x</span><span class="token punctuation">;</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;apply(square, 5): <span class="token interpolation"><span class="token interpolation-punctuation punctuation">{</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token variable">square</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span>&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// higher order function consumes another function:</span>
<span class="token keyword">let</span> <span class="token variable">apply_twice</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">f</span>: <span class="token class-name">int</span> <span class="token operator">-&gt;</span> <span class="token class-name">int</span><span class="token punctuation">,</span> <span class="token variable">x</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token variable">x</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;apply_twice(times_2, 5): <span class="token interpolation"><span class="token interpolation-punctuation punctuation">{</span><span class="token function">apply_twice</span><span class="token punctuation">(</span><span class="token variable">times_2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span>&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// higher order function returns another function:</span>
<span class="token keyword">let</span> <span class="token variable">create_apply_twice</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">f</span>: <span class="token class-name">int</span> <span class="token operator">-&gt;</span> <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token variable">x</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token variable">x</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token variable">apply_twice_times_2</span> <span class="token operator">=</span> <span class="token function">create_apply_twice</span><span class="token punctuation">(</span><span class="token variable">times_2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;apply_twice_times_2(5): <span class="token interpolation"><span class="token interpolation-punctuation punctuation">{</span><span class="token function">apply_twice_times_2</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span>&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="union-types"><a href="#union-types" class="header-anchor">#</a> union types</h2> <p>Unions are under development <a href="https://github.com/degory/ghul/issues/1132" target="_blank" rel="noopener noreferrer">(see GitHub issue #1132)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>Unions hold a value of one of several different types (variants). Each variant can have its own set of fields. This is useful for creating types that can represent multiple kinds of data in a single structure.</p> <div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul"><span class="token keyword">union</span> <span class="token class-name">Shape</span> <span class="token keyword">is</span>
    <span class="token class-name">CIRCLE</span><span class="token punctuation">(</span><span class="token variable">radius</span>: <span class="token variable">float</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">SQUARE</span><span class="token punctuation">(</span><span class="token variable">side</span>: <span class="token variable">float</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">si</span>

<span class="token keyword">union</span> <span class="token class-name">Option</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">]</span> <span class="token keyword">is</span>
    <span class="token class-name">SOME</span><span class="token punctuation">(</span><span class="token variable">value</span>: <span class="token class-name">T</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">NONE</span><span class="token punctuation">;</span>
<span class="token keyword">si</span>

<span class="token keyword">union</span> <span class="token class-name">Result</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token class-name">E</span><span class="token punctuation">]</span> <span class="token keyword">is</span>
    <span class="token class-name">OK</span><span class="token punctuation">(</span><span class="token variable">value</span>: <span class="token class-name">T</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">ERROR</span><span class="token punctuation">(</span><span class="token variable">error</span>: <span class="token class-name">E</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">si</span>
</code></pre></div><p>Accessing the data held by a union's variant requires first checking which variant the union currently holds. Unions provide properties for this for each of their variants:</p> <div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul"><span class="token control">if</span> <span class="token variable">an_option</span><span class="token operator">.</span><span class="token variable">is_some</span> <span class="token control">then</span>
    <span class="token keyword">let</span> <span class="token variable">value</span> <span class="token operator">=</span> <span class="token variable">an_option</span><span class="token operator">.</span><span class="token variable">some</span><span class="token punctuation">;</span>
    <span class="token operator">...</span>
<span class="token control">fi</span>
</code></pre></div><p>Unions shaped like <code>Option</code> types (exactly one non-unit variant) support the <code>?</code> and <code>!</code> operators for testing if they hold a value and for unwrapping that value, respectively:</p> <div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul"><span class="token control">if</span> <span class="token variable">an_option</span><span class="token operator">?</span> <span class="token control">then</span>
    <span class="token keyword">let</span> <span class="token variable">value</span> <span class="token operator">=</span> <span class="token variable">an_option</span><span class="token operator">!</span><span class="token punctuation">;</span>
    <span class="token operator">...</span>
<span class="token control">fi</span>
</code></pre></div><div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul"><span class="token keyword">use</span> <span class="token class-name">IO</span><span class="token operator">.</span><span class="token class-name">Std</span><span class="token operator">.</span><span class="token variable">write_line</span><span class="token punctuation">;</span>

<span class="token keyword">union</span> <span class="token class-name">Option</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">]</span> <span class="token keyword">is</span>
    <span class="token class-name">SOME</span><span class="token punctuation">(</span><span class="token variable">value</span>: <span class="token class-name">T</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">NONE</span><span class="token punctuation">;</span>
<span class="token keyword">si</span>

<span class="token keyword">union</span> <span class="token class-name">List</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">]</span> <span class="token keyword">is</span>
    <span class="token class-name">NIL</span><span class="token punctuation">;</span>
    <span class="token class-name">CONS</span><span class="token punctuation">(</span><span class="token variable">head</span>: <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token variable">tail</span>: <span class="token class-name">List</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">si</span>

<span class="token keyword">union</span> <span class="token class-name">Tree</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">]</span> <span class="token keyword">is</span>
    <span class="token class-name">LEAF</span><span class="token punctuation">(</span><span class="token variable">value</span>: <span class="token class-name">T</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">NODE</span><span class="token punctuation">(</span><span class="token variable">left</span>: <span class="token class-name">Tree</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">right</span>: <span class="token class-name">Tree</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">si</span>

<span class="token keyword">use</span> <span class="token class-name">Option</span><span class="token operator">.</span><span class="token class-name">SOME</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token class-name">Option</span><span class="token operator">.</span><span class="token class-name">NONE</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token class-name">List</span><span class="token operator">.</span><span class="token class-name">NIL</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token class-name">List</span><span class="token operator">.</span><span class="token class-name">CONS</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token class-name">Tree</span><span class="token operator">.</span><span class="token class-name">LEAF</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token class-name">Tree</span><span class="token operator">.</span><span class="token class-name">NODE</span><span class="token punctuation">;</span>

<span class="token function">entry</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">is</span>
    <span class="token function">test_option</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">test_list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">test_tree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">si</span>

<span class="token function">test_option</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">is</span>
    <span class="token keyword">let</span> <span class="token variable">some_int</span> <span class="token operator">=</span> <span class="token class-name">SOME</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token variable">none_int</span> <span class="token operator">=</span> <span class="token class-name">NONE</span>`<span class="token punctuation">[</span><span class="token class-name">int</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token variable">stringify_option</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">o</span>: <span class="token class-name">Option</span><span class="token punctuation">[</span><span class="token class-name">int</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">rec</span> <span class="token operator">=&gt;</span>
        <span class="token control">if</span> <span class="token variable">o</span><span class="token operator">.</span><span class="token variable">is_some</span> <span class="token control">then</span>
            <span class="token string">&quot;<span class="token interpolation"><span class="token interpolation-punctuation punctuation">{</span><span class="token variable">o</span><span class="token operator">.</span><span class="token variable">some</span><span class="token interpolation-punctuation punctuation">}</span></span>&quot;</span>
        <span class="token control">else</span>
            <span class="token string">&quot;none&quot;</span>
        <span class="token control">fi</span><span class="token punctuation">;</span>

    <span class="token function">write_line</span><span class="token punctuation">(</span><span class="token function">stringify_option</span><span class="token punctuation">(</span><span class="token variable">some_int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">write_line</span><span class="token punctuation">(</span><span class="token function">stringify_option</span><span class="token punctuation">(</span><span class="token variable">none_int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">si</span>

<span class="token function">test_list</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">is</span>
    <span class="token keyword">let</span> <span class="token variable">list</span> <span class="token operator">=</span> <span class="token class-name">CONS</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token class-name">CONS</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token class-name">CONS</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token class-name">NIL</span>`<span class="token punctuation">[</span><span class="token class-name">int</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token variable">stringify_list</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">l</span>: <span class="token class-name">List</span><span class="token punctuation">[</span><span class="token class-name">int</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">rec</span> <span class="token operator">=&gt;</span>
        <span class="token control">if</span> <span class="token variable">l</span><span class="token operator">.</span><span class="token variable">is_cons</span> <span class="token control">then</span>
            <span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token variable">head</span><span class="token punctuation">,</span> <span class="token variable">tail</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token variable">l</span><span class="token operator">.</span><span class="token variable">cons</span> <span class="token control">in</span>
            <span class="token string">&quot;<span class="token interpolation"><span class="token interpolation-punctuation punctuation">{</span><span class="token variable">head</span><span class="token interpolation-punctuation punctuation">}</span></span>, <span class="token interpolation"><span class="token interpolation-punctuation punctuation">{</span><span class="token keyword">rec</span><span class="token punctuation">(</span><span class="token variable">tail</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span>&quot;</span>
        <span class="token control">else</span>
            <span class="token string">&quot;nil&quot;</span>
        <span class="token control">fi</span><span class="token punctuation">;</span>

    <span class="token function">write_line</span><span class="token punctuation">(</span><span class="token function">stringify_list</span><span class="token punctuation">(</span><span class="token variable">list</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">si</span>

<span class="token function">test_tree</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">is</span>
    <span class="token keyword">let</span> <span class="token variable">tree</span> <span class="token operator">=</span> <span class="token class-name">NODE</span><span class="token punctuation">(</span>
        <span class="token class-name">NODE</span><span class="token punctuation">(</span>
            <span class="token class-name">LEAF</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token class-name">LEAF</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">NODE</span><span class="token punctuation">(</span>
            <span class="token class-name">LEAF</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token class-name">LEAF</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token variable">stringify_tree</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">t</span>: <span class="token class-name">Tree</span><span class="token punctuation">[</span><span class="token class-name">int</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">rec</span> <span class="token operator">=&gt;</span>
        <span class="token control">if</span> <span class="token variable">t</span><span class="token operator">.</span><span class="token variable">is_node</span> <span class="token control">then</span>
            <span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token variable">left</span><span class="token punctuation">,</span> <span class="token variable">right</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token variable">t</span><span class="token operator">.</span><span class="token variable">node</span> <span class="token control">in</span>
            <span class="token string">&quot;(<span class="token interpolation"><span class="token interpolation-punctuation punctuation">{</span><span class="token keyword">rec</span><span class="token punctuation">(</span><span class="token variable">left</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span>, <span class="token interpolation"><span class="token interpolation-punctuation punctuation">{</span><span class="token keyword">rec</span><span class="token punctuation">(</span><span class="token variable">right</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span>)&quot;</span>
        <span class="token control">else</span>
            <span class="token string">&quot;<span class="token interpolation"><span class="token interpolation-punctuation punctuation">{</span><span class="token variable">t</span><span class="token operator">.</span><span class="token variable">leaf</span><span class="token interpolation-punctuation punctuation">}</span></span>&quot;</span>
        <span class="token control">fi</span><span class="token punctuation">;</span>

    <span class="token function">write_line</span><span class="token punctuation">(</span><span class="token function">stringify_tree</span><span class="token punctuation">(</span><span class="token variable">tree</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">si</span>
</code></pre></div><h2 id="pattern-matching-todo"><a href="#pattern-matching-todo" class="header-anchor">#</a> pattern matching (TODO)</h2> <p>Pattern matching is under development <a href="https://github.com/degory/ghul/issues/1134" target="_blank" rel="noopener noreferrer">(see GitHub issue #1134)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="currying"><a href="#currying" class="header-anchor">#</a> currying</h2> <div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul"><span class="token keyword">let</span> <span class="token variable">curryed_add</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">x</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token variable">y</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token variable">x</span> <span class="token operator">+</span> <span class="token variable">y</span><span class="token punctuation">;</span>

<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;curryed_add(5)(3): <span class="token interpolation"><span class="token interpolation-punctuation punctuation">{</span><span class="token function">curryed_add</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span>&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> <span class="token variable">add_5</span> <span class="token operator">=</span> <span class="token function">curryed_add</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;add_5(3): <span class="token interpolation"><span class="token interpolation-punctuation punctuation">{</span><span class="token function">add_5</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span>&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> <span class="token variable">add_10</span> <span class="token operator">=</span> <span class="token function">curryed_add</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;add_10(3): <span class="token interpolation"><span class="token interpolation-punctuation punctuation">{</span><span class="token function">add_10</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span>&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="partial-application"><a href="#partial-application" class="header-anchor">#</a> partial application</h2> <div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul"><span class="token keyword">let</span> <span class="token variable">add</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">x</span>: <span class="token class-name">int</span><span class="token punctuation">,</span> <span class="token variable">y</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token variable">x</span> <span class="token operator">+</span> <span class="token variable">y</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> <span class="token variable">add_5</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">y</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token variable">y</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;add_5(3): <span class="token interpolation"><span class="token interpolation-punctuation punctuation">{</span><span class="token function">add_5</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span>&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> <span class="token variable">add_10</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">y</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token variable">y</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;add_10(3): <span class="token interpolation"><span class="token interpolation-punctuation punctuation">{</span><span class="token function">add_10</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span>&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="lazy-evaluation-todo"><a href="#lazy-evaluation-todo" class="header-anchor">#</a> lazy evaluation (TODO)</h2> <p>Lazy evaluation is not yet supported <a href="https://github.com/degory/ghul/issues/1165" target="_blank" rel="noopener noreferrer">(see GitHub issue #1165)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>The workaround is to implement the <code>Iterator[T]</code> trait and manually manage state. For example:</p> <div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul"><span class="token comment">// generate an infinite sequence of T generator from state S</span>
<span class="token keyword">class</span> <span class="token class-name">GENERATOR</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token class-name">S</span><span class="token punctuation">]</span>: <span class="token class-name">Collections</span><span class="token operator">.</span><span class="token class-name">Iterator</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token class-name">Collections</span><span class="token operator">.</span><span class="token class-name">Iterable</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">]</span> <span class="token keyword">is</span>
    <span class="token variable">current</span>: <span class="token class-name">T</span><span class="token punctuation">;</span>
    <span class="token variable">iterator</span>: <span class="token class-name">Collections</span><span class="token operator">.</span><span class="token class-name">Iterator</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token variable">self</span><span class="token punctuation">;</span>

    <span class="token variable">_initial</span>: <span class="token class-name">S</span><span class="token punctuation">;</span>
    <span class="token variable">_state</span>: <span class="token class-name">S</span><span class="token punctuation">;</span>
    <span class="token variable">_generator</span>: <span class="token class-name">S</span> <span class="token operator">-&gt;</span> <span class="token punctuation">(</span><span class="token class-name">S</span><span class="token punctuation">,</span> <span class="token class-name">T</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// given the current state, return the next state and the current value</span>

    <span class="token function">init</span><span class="token punctuation">(</span><span class="token variable">initial</span>: <span class="token class-name">S</span><span class="token punctuation">,</span> <span class="token variable">generator</span>: <span class="token class-name">S</span> <span class="token operator">-&gt;</span> <span class="token punctuation">(</span><span class="token class-name">S</span><span class="token punctuation">,</span> <span class="token class-name">T</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">is</span>
        <span class="token variable">_initial</span> <span class="token operator">=</span> <span class="token variable">initial</span><span class="token punctuation">;</span>
        <span class="token variable">_generator</span> <span class="token operator">=</span> <span class="token variable">generator</span><span class="token punctuation">;</span>
        <span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">si</span>

    <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">is</span>
        <span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">si</span>
        
    <span class="token function">move_next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">bool</span> <span class="token keyword">is</span>
        <span class="token punctuation">(</span><span class="token variable">_state</span><span class="token punctuation">,</span> <span class="token variable">current</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">_generator</span><span class="token punctuation">(</span><span class="token variable">_state</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token control">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token keyword">si</span>

    <span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">is</span>
        <span class="token variable">_state</span> <span class="token operator">=</span> <span class="token variable">_initial</span><span class="token punctuation">;</span>
    <span class="token keyword">si</span>

    <span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">is</span>
    <span class="token keyword">si</span>
<span class="token keyword">si</span>

<span class="token comment">// generator constructor helper so we don't have to specify types</span>
<span class="token variable">generate</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token class-name">S</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token variable">initial</span>: <span class="token class-name">S</span><span class="token punctuation">,</span> <span class="token variable">generator</span>: <span class="token class-name">S</span> <span class="token operator">-&gt;</span> <span class="token punctuation">(</span><span class="token class-name">S</span><span class="token punctuation">,</span> <span class="token class-name">T</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">GENERATOR</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token class-name">S</span><span class="token punctuation">]</span> <span class="token operator">=&gt;</span>
    <span class="token class-name">GENERATOR</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token class-name">S</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token variable">initial</span><span class="token punctuation">,</span> <span class="token variable">generator</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul"><span class="token comment">// generates an infinite sequence of fibonacci numbers:</span>
<span class="token keyword">let</span> <span class="token variable">fibonacci</span> <span class="token operator">=</span> <span class="token function">generate</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token variable">state</span>: <span class="token punctuation">(</span><span class="token class-name">int</span><span class="token punctuation">,</span> <span class="token class-name">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
        <span class="token keyword">let</span>
            <span class="token punctuation">(</span><span class="token variable">prev</span><span class="token punctuation">,</span> <span class="token variable">current</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token variable">state</span><span class="token punctuation">,</span>
            <span class="token variable">next</span> <span class="token operator">=</span> <span class="token variable">prev</span> <span class="token operator">+</span> <span class="token variable">current</span>
        <span class="token control">in</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">current</span><span class="token punctuation">,</span> <span class="token variable">next</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">next</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// generates an infinite sequence of factorials</span>
<span class="token comment">// (although overflow will occur fairly rapidly)</span>
<span class="token keyword">let</span> <span class="token variable">factorial_sequence</span> <span class="token operator">=</span> <span class="token function">generate</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span>1U<span class="token punctuation">,</span> 1UL<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token variable">state</span>: <span class="token punctuation">(</span><span class="token class-name">uint</span><span class="token punctuation">,</span> <span class="token class-name">ulong</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
        <span class="token keyword">let</span>
            <span class="token punctuation">(</span><span class="token variable">n</span><span class="token punctuation">,</span> <span class="token variable">current</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token variable">state</span><span class="token punctuation">,</span>
            <span class="token variable">next_n</span> <span class="token operator">=</span> <span class="token variable">n</span> <span class="token operator">+</span> 1U<span class="token punctuation">,</span>
            <span class="token variable">next</span> <span class="token operator">=</span> <span class="token variable">current</span> <span class="token operator">*</span> <span class="token keyword">cast</span> <span class="token class-name">ulong</span><span class="token punctuation">(</span><span class="token variable">next_n</span><span class="token punctuation">)</span>
        <span class="token control">in</span> 
            <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">next_n</span><span class="token punctuation">,</span> <span class="token variable">next</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">next</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// the resulting sequences can be comsumed by a pipe, generating values on demand:</span>

<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;first 10 fibonacci numbers: <span class="token interpolation"><span class="token interpolation-punctuation punctuation">{</span><span class="token variable">fibonacci_sequence</span> <span class="token operator">|</span> <span class="token operator">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span>&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;first 10 factorial numbers: <span class="token interpolation"><span class="token interpolation-punctuation punctuation">{</span><span class="token variable">factorial_sequence</span> <span class="token operator">|</span> <span class="token operator">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span>&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token control">for</span> <span class="token punctuation">(</span><span class="token variable">i</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token variable">fib</span><span class="token punctuation">,</span> <span class="token variable">fact</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token control">in</span> <span class="token variable">fibonacci_sequence</span> <span class="token operator">|</span> <span class="token operator">.</span><span class="token function">zip</span><span class="token punctuation">(</span><span class="token variable">factorial_sequence</span><span class="token punctuation">)</span> <span class="token operator">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token control">do</span>
    <span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;fibonacci <span class="token interpolation"><span class="token interpolation-punctuation punctuation">{</span><span class="token variable">i</span><span class="token interpolation-punctuation punctuation">}</span></span> is <span class="token interpolation"><span class="token interpolation-punctuation punctuation">{</span><span class="token variable">fib</span><span class="token interpolation-punctuation punctuation">}</span></span>&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;factorial <span class="token interpolation"><span class="token interpolation-punctuation punctuation">{</span><span class="token variable">i</span><span class="token interpolation-punctuation punctuation">}</span></span> is <span class="token interpolation"><span class="token interpolation-punctuation punctuation">{</span><span class="token variable">fact</span><span class="token interpolation-punctuation punctuation">}</span></span>&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token control">od</span><span class="token punctuation">;</span>

</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/control-flow.html" class="prev">
        control flow
      </a></span> <span class="next"><a href="/object-oriented-programming.html">
        object oriented programming
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.471c6157.js" defer></script><script src="/assets/js/2.d0d5977e.js" defer></script><script src="/assets/js/1.a053b9db.js" defer></script><script src="/assets/js/32.95725b61.js" defer></script>
  </body>
</html>
