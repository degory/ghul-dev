<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>functional programming | ghūl programming language</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="stylesheet" href="/prism-vsc-dark-plus.css">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="ghūl programming language">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.1fba5f60.css" as="style"><link rel="preload" href="/assets/js/app.7b3ee64e.js" as="script"><link rel="preload" href="/assets/js/2.d0d5977e.js" as="script"><link rel="preload" href="/assets/js/1.a053b9db.js" as="script"><link rel="preload" href="/assets/js/32.e17536a4.js" as="script"><link rel="prefetch" href="/assets/js/10.7cbc8b3d.js"><link rel="prefetch" href="/assets/js/11.f206c2fa.js"><link rel="prefetch" href="/assets/js/12.8e113096.js"><link rel="prefetch" href="/assets/js/13.4fc459fc.js"><link rel="prefetch" href="/assets/js/14.79be315a.js"><link rel="prefetch" href="/assets/js/15.75678467.js"><link rel="prefetch" href="/assets/js/16.8c2a8dca.js"><link rel="prefetch" href="/assets/js/17.4659f144.js"><link rel="prefetch" href="/assets/js/18.78f87d15.js"><link rel="prefetch" href="/assets/js/19.687fa966.js"><link rel="prefetch" href="/assets/js/20.f8afd611.js"><link rel="prefetch" href="/assets/js/21.359314cd.js"><link rel="prefetch" href="/assets/js/22.1f905eaa.js"><link rel="prefetch" href="/assets/js/23.8b8f7a47.js"><link rel="prefetch" href="/assets/js/24.73c8580c.js"><link rel="prefetch" href="/assets/js/25.446b9554.js"><link rel="prefetch" href="/assets/js/26.4ad2bc7d.js"><link rel="prefetch" href="/assets/js/27.9e58ff48.js"><link rel="prefetch" href="/assets/js/28.faf3d70b.js"><link rel="prefetch" href="/assets/js/29.6358662d.js"><link rel="prefetch" href="/assets/js/3.789d2799.js"><link rel="prefetch" href="/assets/js/30.c22e6e0f.js"><link rel="prefetch" href="/assets/js/31.2f8ff7d6.js"><link rel="prefetch" href="/assets/js/33.82b08237.js"><link rel="prefetch" href="/assets/js/34.ef45a521.js"><link rel="prefetch" href="/assets/js/35.81fca609.js"><link rel="prefetch" href="/assets/js/36.8845e0cb.js"><link rel="prefetch" href="/assets/js/37.9390fa6c.js"><link rel="prefetch" href="/assets/js/38.5fe7ab3c.js"><link rel="prefetch" href="/assets/js/39.aaebe58b.js"><link rel="prefetch" href="/assets/js/4.2750cc6e.js"><link rel="prefetch" href="/assets/js/40.f73acee6.js"><link rel="prefetch" href="/assets/js/41.82f7f487.js"><link rel="prefetch" href="/assets/js/42.97c01ab1.js"><link rel="prefetch" href="/assets/js/43.e0d88f58.js"><link rel="prefetch" href="/assets/js/44.ffada62e.js"><link rel="prefetch" href="/assets/js/45.42d3fc69.js"><link rel="prefetch" href="/assets/js/5.a0237d0a.js"><link rel="prefetch" href="/assets/js/6.b7ad37cd.js"><link rel="prefetch" href="/assets/js/7.a507e3fa.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.271bc088.js">
    <link rel="stylesheet" href="/assets/css/0.styles.1fba5f60.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">ghūl programming language</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/" aria-current="page" class="sidebar-link">overview</a></li><li><a href="/getting-started.html" class="sidebar-link">getting started</a></li><li><a href="/language-basics.html" class="sidebar-link">language basics</a></li><li><a href="/definitions.html" class="sidebar-link">definitions</a></li><li><a href="/control-flow.html" class="sidebar-link">control flow</a></li><li><a href="/functional-programming.html" aria-current="page" class="active sidebar-link">functional programming</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/functional-programming.html#first-class-functions" class="sidebar-link">first class functions</a></li><li class="sidebar-sub-header"><a href="/functional-programming.html#filter-map-reduce" class="sidebar-link">filter, map, reduce</a></li><li class="sidebar-sub-header"><a href="/functional-programming.html#recursion" class="sidebar-link">recursion</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/functional-programming.html#self-recursion-in-anonymous-functions" class="sidebar-link">self recursion in anonymous functions</a></li><li class="sidebar-sub-header"><a href="/functional-programming.html#mutual-recursion-in-anonymous-functions" class="sidebar-link">mutual recursion in anonymous functions</a></li><li class="sidebar-sub-header"><a href="/functional-programming.html#mutual-recursion-in-named-functions" class="sidebar-link">mutual recursion in named functions</a></li></ul></li><li class="sidebar-sub-header"><a href="/functional-programming.html#immutable-data-structures-and-pure-functions" class="sidebar-link">immutable data structures and pure functions</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/functional-programming.html#lists-are-immutable-by-default" class="sidebar-link">lists are immutable by default</a></li><li class="sidebar-sub-header"><a href="/functional-programming.html#arrays-are-immutable" class="sidebar-link">arrays are immutable</a></li><li class="sidebar-sub-header"><a href="/functional-programming.html#maps-are-immutable-by-default" class="sidebar-link">maps are immutable by default</a></li><li class="sidebar-sub-header"><a href="/functional-programming.html#list-literals-are-immutable" class="sidebar-link">list literals are immutable</a></li><li class="sidebar-sub-header"><a href="/functional-programming.html#tuples-are-immutable" class="sidebar-link">tuples are immutable</a></li><li class="sidebar-sub-header"><a href="/functional-programming.html#tuple-literals-are-immutable" class="sidebar-link">tuple literals are immutable</a></li><li class="sidebar-sub-header"><a href="/functional-programming.html#properties-are-not-publicly-assignable-by-default" class="sidebar-link">properties are not publicly assignable by default</a></li><li class="sidebar-sub-header"><a href="/functional-programming.html#pipes-support-non-mutating-operations-over-lists" class="sidebar-link">pipes support non mutating operations over lists</a></li><li class="sidebar-sub-header"><a href="/functional-programming.html#expression-oriented-programming" class="sidebar-link">expression oriented programming</a></li></ul></li><li class="sidebar-sub-header"><a href="/functional-programming.html#higher-order-functions" class="sidebar-link">higher order functions</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/functional-programming.html#higher-order-generically-typed-global-functions" class="sidebar-link">higher order generically typed global functions</a></li><li class="sidebar-sub-header"><a href="/functional-programming.html#higher-order-generically-typed-methods" class="sidebar-link">higher order generically typed methods:</a></li><li class="sidebar-sub-header"><a href="/functional-programming.html#higher-order-anonymous-functions" class="sidebar-link">higher order anonymous functions:</a></li></ul></li><li class="sidebar-sub-header"><a href="/functional-programming.html#pattern-matching" class="sidebar-link">pattern matching</a></li><li class="sidebar-sub-header"><a href="/functional-programming.html#currying" class="sidebar-link">currying</a></li><li class="sidebar-sub-header"><a href="/functional-programming.html#partial-application" class="sidebar-link">partial application</a></li><li class="sidebar-sub-header"><a href="/functional-programming.html#lazy-evaluation" class="sidebar-link">lazy evaluation</a></li></ul></li><li><a href="/object-oriented-programming.html" class="sidebar-link">object oriented programming</a></li><li><a href="/generics.html" class="sidebar-link">generics</a></li><li><a href="/dotnet-integration.html" class="sidebar-link">.NET integration</a></li><li><a href="/grammar.html" class="sidebar-link">grammar</a></li><li><a href="/known-issues.html" class="sidebar-link">known issues</a></li><li><a href="/resources.html" class="sidebar-link">resources</a></li><li><a href="/history.html" class="sidebar-link">history</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="functional-programming"><a href="#functional-programming" class="header-anchor">#</a> functional programming</h1> <p>ghūl has some support for basic functional programming</p> <h2 id="first-class-functions"><a href="#first-class-functions" class="header-anchor">#</a> first class functions</h2> <p>ghūl has first class functions. There is a function literal syntax that
constructs functions, which can then be called, but also assigned to
variables, passed to other functions, stored in data structures, or
pretty much anything else you can do with any other ghūl value</p> <div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul"><span class="token keyword">let</span> <span class="token variable">f</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">i</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token variable">i</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token variable">g</span> <span class="token operator">=</span> <span class="token variable">f</span><span class="token punctuation">;</span>
<span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> <span class="token function">ff</span><span class="token punctuation">(</span><span class="token variable">f</span>: <span class="token class-name">int</span> <span class="token operator">-&gt;</span> <span class="token class-name">int</span><span class="token punctuation">,</span> <span class="token variable">i</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token variable">i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="filter-map-reduce"><a href="#filter-map-reduce" class="header-anchor">#</a> filter, map, reduce</h2> <p>ghūl pipes provide filter, map and reduce as well as other ways to
work with sequences of values</p> <div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul"><span class="token comment">// map</span>
<span class="token keyword">let</span> <span class="token variable">doubled</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token operator">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token variable">x</span> <span class="token operator">=&gt;</span> <span class="token variable">x</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;doubled: {doubled}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// filter</span>
<span class="token keyword">let</span> <span class="token variable">evens</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token operator">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">x</span> <span class="token operator">=&gt;</span> <span class="token variable">x</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;evens: {evens}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// reduce</span>
<span class="token keyword">let</span> <span class="token variable">sum</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token operator">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token variable">acc</span><span class="token punctuation">,</span> <span class="token variable">x</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token variable">acc</span> <span class="token operator">+</span> <span class="token variable">x</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;sum: {sum}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="recursion"><a href="#recursion" class="header-anchor">#</a> recursion</h2> <p>ghūl methods, global functions and anonymous functions
can all call themselves or each other recursively</p> <h3 id="self-recursion-in-anonymous-functions"><a href="#self-recursion-in-anonymous-functions" class="header-anchor">#</a> self recursion in anonymous functions</h3> <div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul"><span class="token comment">// factorial</span>
<span class="token keyword">let</span> <span class="token variable">factorial</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">n</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token keyword">rec</span> <span class="token operator">=&gt;</span> <span class="token control">if</span> <span class="token variable">n</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token control">then</span> <span class="token number">1</span> <span class="token control">else</span> <span class="token variable">n</span> <span class="token operator">*</span> <span class="token keyword">rec</span><span class="token punctuation">(</span><span class="token variable">n</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token control">fi</span><span class="token punctuation">;</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;factorial(5): {factorial(5)}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// fibonacci</span>
<span class="token keyword">let</span> <span class="token variable">fibonacci</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">n</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token keyword">rec</span> <span class="token operator">=&gt;</span> <span class="token control">if</span> <span class="token variable">n</span> <span class="token operator">&lt;=</span> <span class="token number">1</span> <span class="token control">then</span> <span class="token variable">n</span> <span class="token control">else</span> <span class="token keyword">rec</span><span class="token punctuation">(</span><span class="token variable">n</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token keyword">rec</span><span class="token punctuation">(</span><span class="token variable">n</span> <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token control">fi</span><span class="token punctuation">;</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;fibonacci(10): {fibonacci(10)}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="mutual-recursion-in-anonymous-functions"><a href="#mutual-recursion-in-anonymous-functions" class="header-anchor">#</a> mutual recursion in anonymous functions</h3> <p>Mutual recursion for anonymous functions is slightly awkward, but possible
by passing one function into the other as an argument:</p> <div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul">
<span class="token keyword">let</span> <span class="token variable">is_even</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">n</span>: <span class="token class-name">int</span><span class="token punctuation">,</span> <span class="token variable">is_odd</span>: <span class="token class-name">int</span> <span class="token operator">-&gt;</span> <span class="token class-name">bool</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token control">if</span> <span class="token variable">n</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token control">then</span> <span class="token boolean">true</span> <span class="token control">else</span> <span class="token function">is_odd</span><span class="token punctuation">(</span><span class="token variable">n</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token control">fi</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token variable">is_odd</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">n</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token keyword">rec</span> <span class="token operator">=&gt;</span> <span class="token control">if</span> <span class="token variable">n</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token control">then</span> <span class="token boolean">false</span> <span class="token control">else</span> <span class="token function">is_even</span><span class="token punctuation">(</span><span class="token variable">n</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token keyword">rec</span><span class="token punctuation">)</span> <span class="token control">fi</span><span class="token punctuation">;</span>

<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;even(10): {is_even(10, is_odd)}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;odd(10): {is_odd(10)}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="mutual-recursion-in-named-functions"><a href="#mutual-recursion-in-named-functions" class="header-anchor">#</a> mutual recursion in named functions</h3> <p>Mututal recursion with named functions, doesn't require any workarounds</p> <div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul"><span class="token function">is_even</span><span class="token punctuation">(</span><span class="token variable">n</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">bool</span> <span class="token keyword">is</span>
    <span class="token control">if</span> <span class="token variable">n</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token control">then</span> <span class="token boolean">true</span> <span class="token control">else</span> <span class="token function">is_odd</span><span class="token punctuation">(</span><span class="token variable">n</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token control">fi</span><span class="token punctuation">;</span>
<span class="token keyword">si</span>

<span class="token function">is_odd</span><span class="token punctuation">(</span><span class="token variable">n</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">bool</span> <span class="token keyword">is</span>
    <span class="token control">if</span> <span class="token variable">n</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token control">then</span> <span class="token boolean">false</span> <span class="token control">else</span> <span class="token function">is_even</span><span class="token punctuation">(</span><span class="token variable">n</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token control">fi</span><span class="token punctuation">;</span>
<span class="token keyword">si</span>
</code></pre></div><h2 id="immutable-data-structures-and-pure-functions"><a href="#immutable-data-structures-and-pure-functions" class="header-anchor">#</a> immutable data structures and pure functions</h2> <p>While ghūl supports imperitive code it also aims to support
writing pure functions with appropriate constructs and defaults</p> <h3 id="lists-are-immutable-by-default"><a href="#lists-are-immutable-by-default" class="header-anchor">#</a> lists are immutable by default</h3> <p>The standard trait for lists <code>Collections.List[T]</code> is immutable (it maps to .NET's <code>System.Collections.Generic.IReadOnlyList`1[T]</code>)</p> <h3 id="arrays-are-immutable"><a href="#arrays-are-immutable" class="header-anchor">#</a> arrays are immutable</h3> <p>The ghūl array type <code>T[]</code> does not expose an assign indexer</p> <h3 id="maps-are-immutable-by-default"><a href="#maps-are-immutable-by-default" class="header-anchor">#</a> maps are immutable by default</h3> <p>The standard trait for maps <code>Collections.Map[T]</code> is immutable (it maps to .NET's <code>System.Collections.Generic.IReadOnlyDictionary`2[K,V]</code>)</p> <h3 id="list-literals-are-immutable"><a href="#list-literals-are-immutable" class="header-anchor">#</a> list literals are immutable</h3> <p>The values constructed by list literals are immutable</p> <div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul"><span class="token keyword">let</span> <span class="token variable">list</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> <span class="token variable">element</span> <span class="token operator">=</span> <span class="token variable">list</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// elements can be read</span>

<span class="token comment">// the list is an instance of an immutable type:</span>
<span class="token control">assert</span> <span class="token variable">list</span><span class="token operator">.</span><span class="token function">get_type</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">typeof</span> <span class="token class-name">Collections</span><span class="token operator">.</span><span class="token class-name">List</span><span class="token punctuation">[</span><span class="token class-name">int</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token variable">element</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span> <span class="token comment">// elements cannot be assigned to - compile time error</span>
</code></pre></div><h3 id="tuples-are-immutable"><a href="#tuples-are-immutable" class="header-anchor">#</a> tuples are immutable</h3> <p>Values of ghūl tuple types <code>(T1, T2, T3, ...)</code> are immutable (the elements <code>`0</code>, <code>`1</code>, <code>`2</code>, ... do not have assign accessors)</p> <h3 id="tuple-literals-are-immutable"><a href="#tuple-literals-are-immutable" class="header-anchor">#</a> tuple literals are immutable</h3> <p>The values constructed by tuple literals are immutable</p> <div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul"><span class="token keyword">let</span> <span class="token variable">tuple</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> <span class="token variable">element</span> <span class="token operator">=</span> <span class="token variable">tuple</span><span class="token operator">.</span>`<span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">// elements can be read</span>

<span class="token comment">// the tuple is an instance of an immutable type:</span>
<span class="token control">assert</span> <span class="token variable">tuple</span><span class="token operator">.</span><span class="token variable">get_type</span> <span class="token operator">==</span> <span class="token keyword">typeof</span> <span class="token punctuation">(</span><span class="token class-name">int</span><span class="token punctuation">,</span> <span class="token class-name">int</span><span class="token punctuation">,</span> <span class="token class-name">int</span><span class="token punctuation">,</span> <span class="token class-name">int</span><span class="token punctuation">,</span> <span class="token class-name">int</span><span class="token punctuation">)</span>

<span class="token variable">tuple</span><span class="token operator">.</span>`<span class="token number">3</span> <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span> <span class="token comment">// elements cannot be assigned to - compile time error</span>
</code></pre></div><h3 id="properties-are-not-publicly-assignable-by-default"><a href="#properties-are-not-publicly-assignable-by-default" class="header-anchor">#</a> properties are not publicly assignable by default</h3> <p>When defining properties in classes and structs, they are not
publicly assignable by default</p> <div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul"><span class="token keyword">struct</span> <span class="token class-name">THING</span> <span class="token keyword">is</span>
    <span class="token variable">name</span>: <span class="token class-name">string</span><span class="token punctuation">;</span>

    <span class="token function">init</span><span class="token punctuation">(</span><span class="token variable">name</span>: <span class="token class-name">string</span><span class="token punctuation">)</span> <span class="token keyword">is</span>
        <span class="token variable">self</span><span class="token operator">.</span><span class="token variable">name</span> <span class="token operator">=</span> <span class="token variable">name</span><span class="token punctuation">;</span>
    <span class="token keyword">si</span>
<span class="token keyword">si</span>

<span class="token keyword">let</span> <span class="token variable">thing</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THING</span><span class="token punctuation">(</span><span class="token string">&quot;a thing&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">thing</span><span class="token operator">.</span><span class="token variable">name</span> <span class="token operator">=</span> <span class="token string">&quot;change it&quot;</span><span class="token punctuation">;</span> <span class="token comment">// compile time error</span>
</code></pre></div><h3 id="pipes-support-non-mutating-operations-over-lists"><a href="#pipes-support-non-mutating-operations-over-lists" class="header-anchor">#</a> pipes support non mutating operations over lists</h3> <p>pipes make it easy to iterate over lists and generators producing
transformed output without mutating the source data</p> <div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul"><span class="token keyword">let</span> <span class="token variable">list</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> <span class="token variable">doubled</span> <span class="token operator">=</span> <span class="token variable">list</span> <span class="token operator">|</span> <span class="token operator">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token variable">x</span> <span class="token operator">=&gt;</span> <span class="token variable">x</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// original list is still the same:</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;list: {list| }&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="expression-oriented-programming"><a href="#expression-oriented-programming" class="header-anchor">#</a> expression oriented programming</h3> <p>Expression bodied functions and some support for
expression oriented programming help in writing
pure functions</p> <div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul"><span class="token keyword">let</span> <span class="token variable">add</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">x</span>: <span class="token class-name">int</span><span class="token punctuation">,</span> <span class="token variable">y</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token variable">x</span> <span class="token operator">+</span> <span class="token variable">y</span><span class="token punctuation">;</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;add(5, 3): {add(5, 3)}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> <span class="token variable">classify</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">n</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    <span class="token control">if</span> <span class="token variable">n</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token control">then</span>
        <span class="token string">&quot;Zero&quot;</span>
    <span class="token control">elif</span> <span class="token variable">n</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">/\</span> <span class="token variable">n</span> <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token control">then</span>
        <span class="token control">if</span> <span class="token variable">n</span> <span class="token operator">%</span> <span class="token number">5</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token control">then</span> <span class="token string">&quot;Negative even and multiple of 5&quot;</span> <span class="token control">else</span> <span class="token string">&quot;Negative even&quot;</span> <span class="token control">fi</span>
    <span class="token control">elif</span> <span class="token variable">n</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token operator">/\</span> <span class="token variable">n</span> <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token control">then</span>
        <span class="token control">if</span> <span class="token variable">n</span> <span class="token operator">%</span> <span class="token number">5</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token control">then</span> <span class="token string">&quot;Negative odd and multiple of 5&quot;</span> <span class="token control">else</span> <span class="token string">&quot;Negative odd&quot;</span> <span class="token control">fi</span>
    <span class="token control">elif</span> <span class="token variable">n</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token control">then</span>
        <span class="token control">if</span> <span class="token variable">n</span> <span class="token operator">%</span> <span class="token number">5</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token control">then</span> <span class="token string">&quot;Positive even and multiple of 5&quot;</span> <span class="token control">else</span> <span class="token string">&quot;Positive even&quot;</span> <span class="token control">fi</span>
    <span class="token control">else</span>
        <span class="token control">if</span> <span class="token variable">n</span> <span class="token operator">%</span> <span class="token number">5</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token control">then</span> <span class="token string">&quot;Positive odd and multiple of 5&quot;</span> <span class="token control">else</span> <span class="token string">&quot;Positive odd&quot;</span> <span class="token control">fi</span>
    <span class="token control">fi</span><span class="token punctuation">;</span>

<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;classifyNumber(-10): {classify(-10)}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;classifyNumber(-3): {classify(-3)}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;classifyNumber(0): {classify(0)}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;classifyNumber(4): {classify(4)}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;classifyNumber(25): {classify(25)}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        

</code></pre></div><h2 id="higher-order-functions"><a href="#higher-order-functions" class="header-anchor">#</a> higher order functions</h2> <h3 id="higher-order-generically-typed-global-functions"><a href="#higher-order-generically-typed-global-functions" class="header-anchor">#</a> higher order generically typed global functions</h3> <div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul"><span class="token variable">apply</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token variable">f</span>: <span class="token class-name">T</span> <span class="token operator">-&gt;</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token variable">x</span>: <span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">T</span> <span class="token operator">=&gt;</span>
    <span class="token function">f</span><span class="token punctuation">(</span><span class="token variable">x</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">apply_if</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token variable">f</span>: <span class="token class-name">T</span> <span class="token operator">-&gt;</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token variable">x</span>: <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token variable">predicate</span>: <span class="token class-name">T</span> <span class="token operator">-&gt;</span> <span class="token class-name">bool</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">T</span> <span class="token operator">=&gt;</span>
    <span class="token control">if</span> <span class="token function">predicate</span><span class="token punctuation">(</span><span class="token variable">x</span><span class="token punctuation">)</span> <span class="token control">then</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token variable">x</span><span class="token punctuation">)</span> <span class="token control">else</span> <span class="token variable">x</span> <span class="token control">fi</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="higher-order-generically-typed-methods"><a href="#higher-order-generically-typed-methods" class="header-anchor">#</a> higher order generically typed methods:</h3> <div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul"><span class="token keyword">class</span> <span class="token class-name">HIGHER_ORDER_FUNCTIONS</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">]</span> <span class="token keyword">is</span>
    <span class="token function">apply</span><span class="token punctuation">(</span><span class="token variable">f</span>: <span class="token class-name">T</span> <span class="token operator">-&gt;</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token variable">x</span>: <span class="token class-name">T</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">T</span> <span class="token keyword">static</span> <span class="token operator">=&gt;</span>
        <span class="token function">f</span><span class="token punctuation">(</span><span class="token variable">x</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">apply_if</span><span class="token punctuation">(</span><span class="token variable">f</span>: <span class="token class-name">T</span> <span class="token operator">-&gt;</span> <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token variable">x</span>: <span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token variable">predicate</span>: <span class="token class-name">T</span> <span class="token operator">-&gt;</span> <span class="token class-name">bool</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">T</span> <span class="token keyword">static</span> <span class="token operator">=&gt;</span>
        <span class="token control">if</span> <span class="token function">predicate</span><span class="token punctuation">(</span><span class="token variable">x</span><span class="token punctuation">)</span> <span class="token control">then</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token variable">x</span><span class="token punctuation">)</span> <span class="token control">else</span> <span class="token variable">x</span> <span class="token control">fi</span><span class="token punctuation">;</span>
<span class="token keyword">si</span>
</code></pre></div><h3 id="higher-order-anonymous-functions"><a href="#higher-order-anonymous-functions" class="header-anchor">#</a> higher order anonymous functions:</h3> <div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul"><span class="token keyword">let</span> <span class="token variable">times_2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">x</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token variable">x</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;apply(times_2, 5): {apply(times_2, 5)}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> <span class="token variable">square</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">x</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token variable">x</span> <span class="token operator">*</span> <span class="token variable">x</span><span class="token punctuation">;</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;apply(square, 5): {apply(square, 5)}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// higher order function consumes another function:</span>
<span class="token keyword">let</span> <span class="token variable">apply_twice</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">f</span>: <span class="token class-name">int</span> <span class="token operator">-&gt;</span> <span class="token class-name">int</span><span class="token punctuation">,</span> <span class="token variable">x</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token variable">x</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;apply_twice(times_2, 5): {apply_twice(times_2, 5)}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// higher order function returns another function:</span>
<span class="token keyword">let</span> <span class="token variable">create_apply_twice</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">f</span>: <span class="token class-name">int</span> <span class="token operator">-&gt;</span> <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token variable">x</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token variable">x</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> <span class="token variable">apply_twice_times_2</span> <span class="token operator">=</span> <span class="token function">create_apply_twice</span><span class="token punctuation">(</span><span class="token variable">times_2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;apply_twice_times_2(5): {apply_twice_times_2(5)}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="pattern-matching"><a href="#pattern-matching" class="header-anchor">#</a> pattern matching</h2> <p>pattern matching is not yet supported, but if expressions
go some way to providing similar functionality:</p> <div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul"><span class="token keyword">let</span> <span class="token variable">is_even</span> <span class="token operator">=</span>
    <span class="token punctuation">(</span><span class="token variable">n</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> 
        <span class="token control">if</span> <span class="token variable">n</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token control">then</span> 
            <span class="token boolean">true</span> 
        <span class="token control">else</span> 
            <span class="token boolean">false</span>
        <span class="token control">fi</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> <span class="token variable">is_odd</span> <span class="token operator">=</span> 
    <span class="token punctuation">(</span><span class="token variable">n</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> 
        <span class="token control">if</span> <span class="token variable">n</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">!=</span> <span class="token number">0</span> <span class="token control">then</span>
            <span class="token boolean">true</span> 
        <span class="token control">else</span> 
            <span class="token boolean">false</span>
        <span class="token control">fi</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> <span class="token variable">parity</span> <span class="token operator">=</span> 
    <span class="token punctuation">(</span><span class="token variable">n</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> 
        <span class="token control">if</span> <span class="token function">is_even</span><span class="token punctuation">(</span><span class="token variable">n</span><span class="token punctuation">)</span> <span class="token control">then</span>
            <span class="token string">&quot;even&quot;</span> 
        <span class="token control">else</span>
            <span class="token string">&quot;odd&quot;</span>
        <span class="token control">fi</span><span class="token punctuation">;</span>

<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;parity(10): {parity(10)}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;parity(11): {parity(11)}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="currying"><a href="#currying" class="header-anchor">#</a> currying</h2> <div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul"><span class="token keyword">let</span> <span class="token variable">curryed_add</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">x</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token variable">y</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token variable">x</span> <span class="token operator">+</span> <span class="token variable">y</span><span class="token punctuation">;</span>

<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;curryed_add(5)(3): {curryed_add(5)(3)}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> <span class="token variable">add_5</span> <span class="token operator">=</span> <span class="token function">curryed_add</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;add_5(3): {add_5(3)}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> <span class="token variable">add_10</span> <span class="token operator">=</span> <span class="token function">curryed_add</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;add_10(3): {add_10(3)}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="partial-application"><a href="#partial-application" class="header-anchor">#</a> partial application</h2> <div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul">    <span class="token keyword">let</span> <span class="token variable">add</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">x</span>: <span class="token class-name">int</span><span class="token punctuation">,</span> <span class="token variable">y</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token variable">x</span> <span class="token operator">+</span> <span class="token variable">y</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token variable">add_5</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">y</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token variable">y</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;add_5(3): {add_5(3)}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> <span class="token variable">add_10</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">y</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token variable">y</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;add_10(3): {add_10(3)}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="lazy-evaluation"><a href="#lazy-evaluation" class="header-anchor">#</a> lazy evaluation</h2> <div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul"><span class="token comment">// a generic infinite sequence generator with arbitrary state</span>
<span class="token keyword">class</span> <span class="token class-name">GENERATOR</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token class-name">S</span><span class="token punctuation">]</span>: <span class="token class-name">Collections</span><span class="token operator">.</span><span class="token class-name">Iterator</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token class-name">Collections</span><span class="token operator">.</span><span class="token class-name">Iterable</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">]</span> <span class="token keyword">is</span>
    <span class="token variable">current</span>: <span class="token class-name">T</span><span class="token punctuation">;</span>
    <span class="token variable">iterator</span>: <span class="token class-name">Collections</span><span class="token operator">.</span><span class="token class-name">Iterator</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">]</span> <span class="token operator">=&gt;</span> <span class="token variable">self</span><span class="token punctuation">;</span>

    <span class="token variable">_initial</span>: <span class="token class-name">S</span><span class="token punctuation">;</span>
    <span class="token variable">_state</span>: <span class="token class-name">S</span><span class="token punctuation">;</span>
    <span class="token variable">_generator</span>: <span class="token class-name">S</span> <span class="token operator">-&gt;</span> <span class="token punctuation">(</span><span class="token class-name">S</span><span class="token punctuation">,</span> <span class="token class-name">T</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// given the current state, return the next state and the current value</span>

    <span class="token function">init</span><span class="token punctuation">(</span><span class="token variable">initial</span>: <span class="token class-name">S</span><span class="token punctuation">,</span> <span class="token variable">generator</span>: <span class="token class-name">S</span> <span class="token operator">-&gt;</span> <span class="token punctuation">(</span><span class="token class-name">S</span><span class="token punctuation">,</span> <span class="token class-name">T</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">is</span>
        <span class="token variable">_initial</span> <span class="token operator">=</span> <span class="token variable">initial</span><span class="token punctuation">;</span>
        <span class="token variable">_generator</span> <span class="token operator">=</span> <span class="token variable">generator</span><span class="token punctuation">;</span>
        <span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">si</span>

    <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">is</span>
        <span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">si</span>
        
    <span class="token function">move_next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">bool</span> <span class="token keyword">is</span>
        <span class="token punctuation">(</span><span class="token variable">_state</span><span class="token punctuation">,</span> <span class="token variable">current</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">_generator</span><span class="token punctuation">(</span><span class="token variable">_state</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token control">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token keyword">si</span>

    <span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">is</span>
        <span class="token variable">_state</span> <span class="token operator">=</span> <span class="token variable">_initial</span><span class="token punctuation">;</span>
    <span class="token keyword">si</span>

    <span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">is</span>
    <span class="token keyword">si</span>
<span class="token keyword">si</span>

<span class="token comment">// generator constructor helper so we don't have to specify types</span>
<span class="token variable">generate</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token class-name">S</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token variable">initial</span>: <span class="token class-name">S</span><span class="token punctuation">,</span> <span class="token variable">generator</span>: <span class="token class-name">S</span> <span class="token operator">-&gt;</span> <span class="token punctuation">(</span><span class="token class-name">S</span><span class="token punctuation">,</span> <span class="token class-name">T</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token class-name">GENERATOR</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token class-name">S</span><span class="token punctuation">]</span> <span class="token operator">=&gt;</span>
    <span class="token keyword">new</span> <span class="token class-name">GENERATOR</span><span class="token punctuation">[</span><span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token class-name">S</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token variable">initial</span><span class="token punctuation">,</span> <span class="token variable">generator</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-ghul extra-class"><pre class="language-ghul"><code class="language-ghul"><span class="token comment">// generates an infinite sequence of fibonacci numbers:</span>
<span class="token keyword">let</span> <span class="token variable">fibonacci_sequence</span> <span class="token operator">=</span> <span class="token function">generate</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token variable">state</span>: <span class="token punctuation">(</span><span class="token variable">prev</span>: <span class="token class-name">int</span><span class="token punctuation">,</span> <span class="token variable">current</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">state</span><span class="token operator">.</span><span class="token variable">current</span><span class="token punctuation">,</span> <span class="token variable">state</span><span class="token operator">.</span><span class="token variable">prev</span> <span class="token operator">+</span> <span class="token variable">state</span><span class="token operator">.</span><span class="token variable">current</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">state</span><span class="token operator">.</span><span class="token variable">prev</span> <span class="token operator">+</span> <span class="token variable">state</span><span class="token operator">.</span><span class="token variable">current</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// generates an infinite sequence of factorials:</span>
<span class="token keyword">let</span> <span class="token variable">factorial_sequence</span> <span class="token operator">=</span> <span class="token function">generate</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token variable">state</span>: <span class="token punctuation">(</span><span class="token variable">n</span>: <span class="token class-name">int</span><span class="token punctuation">,</span> <span class="token variable">prev</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">state</span><span class="token operator">.</span><span class="token variable">n</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token variable">state</span><span class="token operator">.</span><span class="token variable">prev</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token variable">state</span><span class="token operator">.</span><span class="token variable">n</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">state</span><span class="token operator">.</span><span class="token variable">prev</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token variable">state</span><span class="token operator">.</span><span class="token variable">n</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> <span class="token variable">fibonacci_sequence_block_body</span> <span class="token operator">=</span> <span class="token function">generate</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token variable">state</span>: <span class="token punctuation">(</span><span class="token variable">prev</span>: <span class="token class-name">int</span><span class="token punctuation">,</span> <span class="token variable">current</span>: <span class="token class-name">int</span><span class="token punctuation">)</span> <span class="token keyword">is</span>
        <span class="token keyword">let</span> <span class="token variable">next</span> <span class="token operator">=</span> <span class="token variable">state</span><span class="token operator">.</span><span class="token variable">prev</span> <span class="token operator">+</span> <span class="token variable">state</span><span class="token operator">.</span><span class="token variable">current</span><span class="token punctuation">;</span>
        <span class="token control">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">state</span><span class="token operator">.</span><span class="token variable">current</span><span class="token punctuation">,</span> <span class="token variable">next</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">next</span><span class="token punctuation">)</span>
    <span class="token keyword">si</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;first 20 fibonacci numbers: {fibonacci_sequence | .take(10)}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;first 20 factorial numbers: {factorial_sequence | .take(10)}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token control">for</span> <span class="token punctuation">(</span><span class="token variable">i</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token variable">fib</span><span class="token punctuation">,</span> <span class="token variable">fact</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token control">in</span> <span class="token variable">fibonacci_sequence</span> <span class="token operator">|</span> <span class="token operator">.</span><span class="token function">zip</span><span class="token punctuation">(</span><span class="token variable">factorial_sequence</span><span class="token punctuation">)</span> <span class="token operator">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token control">do</span>
    <span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;fibonacci {i} is {fib}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">write_line</span><span class="token punctuation">(</span><span class="token string">&quot;factorial {i} is {fact}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token control">od</span><span class="token punctuation">;</span>

</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/control-flow.html" class="prev">
        control flow
      </a></span> <span class="next"><a href="/object-oriented-programming.html">
        object oriented programming
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.7b3ee64e.js" defer></script><script src="/assets/js/2.d0d5977e.js" defer></script><script src="/assets/js/1.a053b9db.js" defer></script><script src="/assets/js/32.e17536a4.js" defer></script>
  </body>
</html>
